


<style>
  body {
    font-size: 5.5pt;
    /* font-size: 12pt; */
    color: magenta;
    color: rgb(255, 100, 255);
    background-color: rgb(255, 200, 255);
    /* background: magenta; */
    /* color: pink; */
    /* text-align: justify; */
    /* text-align: right; */
    /* direction: rtl; */
  }
  @media print {
    body {
      /* color: black; */
    }
  }
  code {
    font-size: 9pt;
    color: magenta;
    /* unicode-bidi: bidi-override; */
  }
  method, mthd {
    display: block;
    /* border: 1px solid magenta; */
    /* border-left: 1px dotted cyan; */
    /* padding: 0; */
    /* float: left; */
    white-space: pre;
    /* font-family: pixel, moonspace, monospace; */
    margin: .5em .5em .5em 1.8em;
    margin: .5em;
    margin: 0 1em 1em;
    /* padding-left: .2em; */

    /* float: right; */
    /* margin: .5em 1.8em .5em .5em; */
    /* unicode-bidi: bidi-override; */
  }
  class {
    display: block;
    /* white-space: pre; */
  }
  class ol {
    padding-left: 2em;
  }
  pre {
    display: block;
    float: left;

    /* float: right;
    unicode-bidi: bidi-override; */
  }
  clear {
    clear: both;
  }
  captian {
    /* width: 1.3in; */
    display: block;
    float: left;

    /* float: right; */
  }
  @media print {
    page-break {
      display: block;
      page-break-after: always;
    }
  }
  </style>


<script src="bubblescript.js">
</script>
<script type="text/bubblescript">
  </script>


<div>
<pre>
            /**   BUbBLeScript
                         Version 0.1.4.üë∏üë±‚Äç‚ôÄÔ∏è   **/



(function() {                   //                    } ()noitcnuf)

  class BUbBLeScript {          //           } tpircSeLBbUB ssalc
      parse {}                  //                {} esrap
  }                             //                            {

  var emptyList,
    emptyGlider;
  </pre>
</div>
<!-- <page-break></page-break> -->

<div style=" float: left; clear:left; margin: .5em 5em .5em 1.4em;">
<pre style="margin-bottom: 1.5em;">class                    {</pre>
<captian  style="clear:both;">

<method>conj(val) {
  return val.reduce(function(memo, i) {
    return memo.push(i);
  }, this);
}</method>

<method>constructor(head, tail) {
  this.head = head;
  this.tail = tail;
}</method>

<method>count {
  return this.reduce(function(memo, i) {
    return memo + 1;
  }, 0);
}</method>

<method>each(fn) {
  var result = fn(this.head);
  if (this.tail)
    return this.tail.each(fn);
  return result;
}</method>



<method>get first {
  return this.head;
}</method>


<method>get rest {
  return this.tail;
}</method>

<method>get next {
  return this.tail.head;
}</method>


<method>get isEmpty { return false; }</method>

<method>get last {
  return this.tail ? this.tail.last : this.head;
}</method>

<method>inspect {
  "(" + map(function(q) {
    q.inspect()
  }).join() + ")"
}</method>


</captian>
<captian>

<method>join(delimiter = ' ') {
  if (this.tail) {
    return this.head + delimiter + this.tail.join()
  } else {
    if (typeof this.head == "string") {
      return '"' + this.head + '"';
    }
    return this.head.toString()
  }
}</method>
<method>map(fn) {
  var tail = null,
    head;
  if (this.tail)
    tail = this.tail.map(fn);
  head = fn(this.head);
  return new List(head, tail);
}</method>

<method>peek {
  return this.head;
}</method>

<method>pop {
  return this.tail || emptyList;
}</method>

<method>push(val) {
  return new List(val, this);
}</method>

<method>shift {
  return this.reverse().pop().reverse();
}</method>


</captian>

<captian>

<method>reduce(fn, memo) {
  var a, b, c = this;
  if (memo == undefined) {
    a = this.head;
    c = this.tail;
    if (!c) {
      return a;
    } else {
      b = c.head;
      c = c.tail;
      memo = fn(a, b);
      if (!c)
        return memo;
    }
  }
  return c.push(memo).reduce(fn);
}</method>

<method>reverse {
  if (!this.tail) return this;
  var list = new List(this.head);
  return this.tail.reduce(function(memo, i) {
    return memo.push(i);
  }, list);
}</method>

<method>toArray {
  if (this.tail) {
    return [this.head].concat(this.tail.toArray());
  } else {
    return [this.head];
  }
}</method>

<method>toString {
  return "(" + this.join() + ")"
}</method>



</captian>

<pre style="clear:both;">}</pre>
</div>

<!-- <page-break></page-break> -->

<class style="float: left; margin: .5em 5em .5em 1.4em;">
<pre style="margin-bottom: 1.5em;">class                     {</pre>
<ol>
<captian  style="clear:both;">

<method><li>(head, tail) {
  this.head = head;
  this.tail = tail;
}</li></method>

<method><li>conj(...val) {
  return val.reduce(function(i, memo) {
    memo.push(i);
  }, this);
}</li></method>

<method><li>each(fn) {
  if (this.tail)
    this.tail.each(fn);
  fn(this.head);
}</li></method>

<method><li>get isEmpty { return false; }</li></method>

<method><li>get first {
   return @tail ?
     @tail.first : @head
}</li></method>

<method><li>get second {
  return @rest.first;
}</li></method>

<method>//get first {
//  if @tail,
//    @tail.first  @head
//}</method>

<method><li>get rest {
  if (@_rest == null)
    if (@tail)
      @_rest =
        new Glider(@head,
          @tail.rest);

  return @_rest;
}</li></method>

<method><li>inspect {
  "[" + this.map(function(q) {
    q.inspect()
  }).join() + "]";
}</li></method>

</captian>
<captian>
<method><li>join(delimiter = ' ') {
  if (this.rest)
    return this.first + delimiter + this.rest.join();
  else
  if (typeof this.first == "string")
    return '"' + this.first + '"';
  else
    return this.first + '';
}</li></method>

<method><li>map(fn, ...aux) {
  var tail = null;

  var result = new Glider(fn(this.first,
    ...aux.map(function(q) {
      return q ? q.first : q
    })));

  if (!this.rest)
    return result;

  function into(a, b) {
    var c = new Glider(b.peek());
    b = b.pop();

    while (!b.isEmpty) {
      c = c.push(b.peek());
      b = b.pop();
    }
    while (!c.isEmpty) {
      a = a.push(c.peek());
      c = c.pop();
    }

    return a;
  }

  return into(result, this.rest.map(fn,
    ...aux.map(function(q) {
      return q.rest
    })));
}</li></method>
</captian>

<captian>

<method><li>mapp(fn, ...aux) {
  var tail = null;

  var result = new Glider(fn(this.first,
    ...aux.map(function(q) {
      return q ? q.first : q
    })));

  return this.rest.map(function(...args) {
    return new Glider(fn(...args), result);
  }, ...aux.map(function(q) {
    return q.rest
  }));

}</li></method>

<method><li>peek {
  return this.head;
}</li></method>
<method><li>pop {
  return this.tail || emptyGlider;
}</li></method>
<method><li>push(val) {
  return new Glider(val, this);
}</li></method>

<method><li>reduce(fn, memo) {
  if (this.tail)
    memo = this.tail.reduce(fn, memo);
  return fn(this.head, memo);
}</li></method>

<method><li>toString {
  return "[" + this.join() + "]"
}</li></method>

</captian>

</ol>
<pre style="clear:both;">}</pre>
</class>
<!-- <page-break></page-break> -->
<class style="float: left; margin: .5em 5em .5em 1.4em;">
<pre style="margin-bottom: 1.5em;">class EmptyList extends List {</pre>
<ol>
<captian  style="clear:both;">
<method><li>get [is empty] { return true; }</li></method>
<method><li>map { return this; }</li></method>
<method><li>push(val) {
  return new List(val);
}</li></method>
<method><li>reverse {
  return this;
}</li></method>
<method><li>[to string] {
  return "()";
}</li></method>
</captian>
</ol>

<pre style="clear:both;">}</pre>
</class>


<class style="float: left; margin: .5em 5em .5em 1.4em;">
<pre style="margin-bottom: 1.5em;">class EmptyGlider extends Glider {</pre>
<ol>
<captian  style="clear:both;">
<method><li>get [is empty] { return true }</li></method>

<method><li>push (val) {
  return new Glider(val);
}</li></method>

<method><li>[to string] {
  return "[]";
}</li></method>
</captian>
</ol>

<pre style="clear:both;">}</pre>
</class>
<pre>  emptyGlider =  new EmptyGlider;
  emptyList   =  new EmptyList;
</pre>

<pre style="clear:both;"> })(); </pre>
